_context.invoke("Nittro.Extras.CheckList",function(DOM,Arrays){var CheckList=_context.extend("Nittro.Object",function(options){this._={options:Arrays.mergeTree({},CheckList.defaults,options)},"string"==typeof this._.options.container&&(this._.options.container=DOM.getById(this._.options.container)),DOM.addListener(this._.options.container,"mousedown",this._handleMouseDown.bind(this))},{STATIC:{defaults:{container:null,items:null,boundary:"parent",horizontal:!1}},_handleMouseDown:function(mdevt){var target=this._getTarget(mdevt.target),items=this._getItems(),start=target?items.indexOf(target):-1;if(start!==-1){mdevt.preventDefault(),this.trigger("start",{target:target});var boundaryElems=this._getBoundaryElements(items),boundaries=this._getBoundaries(boundaryElems,start),originalStates=items.map(this._getItemState.bind(this)),state=!this._getItemState(target);this._setItemState(target,state);var handleMove=this._getMoveHandler(items,boundaries,originalStates,start,state),end=function(evt){evt&&evt.preventDefault(),DOM.removeListener(document,"mousemove",handleMove),DOM.removeListener(document,"mouseup",end),this._setItemState(target,originalStates[start]),this.trigger("stop")}.bind(this);DOM.addListener(document,"mousemove",handleMove),DOM.addListener(document,"mouseup",end)}},_getMoveHandler:function(items,boundaries,originalStates,start,state){var pos,horiz=this._.options.horizontal,states=originalStates.slice(),n=items.length,changed=!1;return function(evt){evt.preventDefault(),pos=horiz?evt.clientX:evt.clientY;for(var i=0;i<n;i++)i!==start&&originalStates[i]!==state&&(i<start&&pos<boundaries[i]||i>start&&pos>boundaries[i]?states[i]!==state&&(this._setItemState(items[i],state),states[i]=state,changed||(changed=!0,originalStates[start]=state)):states[i]!==!state&&(this._setItemState(items[i],!state),states[i]=!state))}.bind(this)},_getTarget:function(target){return target},_setItemState:function(item,state){item.checked=state},_getItemState:function(item){return item.checked},_getItems:function(){return null===this._.options.items?Arrays.createFrom(this._.options.container.getElementsByTagName("input")).filter(function(elem){return"checkbox"===elem.type}):DOM.getByClassName(this._.options.items,this._.options.container)},_getBoundaryElements:function(items){if(this._.options.boundary){if("parent"===this._.options.boundary)return items.map(function(elem){return elem.parentNode});var sel=this._.options.boundary.split(/\./);return DOM.closest(items,sel[0],sel[1])}return items},_getBoundaries:function(elements,start){return this._.options.horizontal?elements.map(function(elem,i){var rect=elem.getBoundingClientRect();return i<start?rect.right:i>start?rect.left:null}):elements.map(function(elem,i){var rect=elem.getBoundingClientRect();return i<start?rect.bottom:i>start?rect.top:null})}});_context.register(CheckList,"CheckList")},{DOM:"Utils.DOM",Arrays:"Utils.Arrays"});